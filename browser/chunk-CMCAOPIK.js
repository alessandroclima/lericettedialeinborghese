import{a as ie}from"./chunk-LNVPENB4.js";import{a as ee}from"./chunk-VS4EENRH.js";import{a as $}from"./chunk-CJL2YRPP.js";import{a as k}from"./chunk-JC5442BX.js";import{g as P}from"./chunk-YNLNNLDO.js";import{b as L,c as U,d as Q,e as O,f as j,g as G,h as H,i as J,j as K,k as X,l as Y,m as Z}from"./chunk-HZ2NMNNL.js";import"./chunk-N7HB2IBM.js";import{$ as p,Ba as a,Fb as f,Gb as l,Hb as I,Ib as B,Jb as D,Kb as N,Lb as C,Mb as b,Nb as h,Oa as F,Ta as _,U as y,aa as g,db as S,ib as u,kb as M,lb as w,mb as x,nb as r,ob as n,pb as A,tb as T,ub as E,vb as v,za as q}from"./chunk-L66XQOBG.js";function te(t,m){t&1&&(r(0,"small",24),l(1,"Il titolo \xE8 obbligatorio"),n())}function ne(t,m){if(t&1&&_(0,te,2,0,"small",24),t&2){v();let e=f(10);u(e.errors!=null&&e.errors.required?0:-1)}}function oe(t,m){t&1&&(r(0,"small",24),l(1,"Il tempo di cottura \xE8 obbligatorio"),n())}function re(t,m){if(t&1&&_(0,oe,2,0,"small",24),t&2){v();let e=f(20);u(e.errors!=null&&e.errors.required?0:-1)}}function ae(t,m){t&1&&(r(0,"small",24),l(1,"Il numero di porzioni \xE8 obbligatorio"),n())}function le(t,m){if(t&1&&_(0,ae,2,0,"small",24),t&2){v();let e=f(26);u(e.errors!=null&&e.errors.required?0:-1)}}function de(t,m){if(t&1&&(r(0,"option",23),l(1),n()),t&2){let e=m.$implicit;S("ngValue",e.id),a(),I(e.name)}}function me(t,m){t&1&&(r(0,"small",24),l(1,"La categoria \xE8 obbligatoria"),n())}function se(t,m){if(t&1&&(r(0,"option",26),l(1),n()),t&2){let e=m.$implicit;S("value",e.id),a(),I(e.name)}}function ce(t,m){t&1&&(r(0,"small",24),l(1,"Il tipo di alimentazione \xE8 obbligatoria"),n())}function pe(t,m){if(t&1&&(r(0,"option",26),l(1),n()),t&2){let e=m.$implicit;S("value",e.id),a(),I(e.name)}}function ge(t,m){t&1&&(r(0,"small",24),l(1,"Aggiungi almeno un ingrediente"),n())}function ue(t,m){if(t&1&&(r(0,"span"),l(1),n()),t&2){let e=v().$implicit;a(),B(" ",e.ingredienteNome," ")}}function _e(t,m){if(t&1&&(r(0,"span"),l(1),n()),t&2){let e=v().$implicit;a(),N(" ",e.ingredienteNome," - ",e.quantita," ",e.unitaMisura," ")}}function fe(t,m){if(t&1&&(r(0,"span"),l(1),n()),t&2){let e=v().$implicit;a(),D(" ",e.ingredienteNome," ",e.unitaMisura," ")}}function Ce(t,m){if(t&1){let e=T();r(0,"li",34),_(1,ue,2,1,"span")(2,_e,2,3,"span")(3,fe,2,2,"span"),r(4,"button",41),E("click",function(){let i=p(e).$implicit,d=v();return g(d.removeIngredient(i.ingredienteNome))}),A(5,"i",42),n()()}if(t&2){let e=m.$implicit;a(),u((e.quantita==null||e.quantita==0)&&(e.unitaMisura==null||e.unitaMisura=="")?1:-1),a(),u(e.quantita&&e.quantita!==0?2:-1),a(),u(e.unitaMisura&&e.unitaMisura!==""&&e.quantita==null||e.quantita==0?3:-1)}}function be(t,m){t&1&&(r(0,"small",24),l(1,"Aggiungi almeno uno step"),n())}function he(t,m){if(t&1&&(r(0,"div",9),A(1,"img",43),n()),t&2){let e=v();a(),S("src",e.imageUrl,q)}}var Re=(()=>{class t{constructor(){this.ingredientService=y($),this.categoryService=y(ee),this.dietService=y(ie),this.recipeService=y(k),this.router=y(P),this.availableIngredients=[],this.availableCategories=[],this.availableDiets=[],this.selectedIngredient=void 0,this.ingredientQuantity=null,this.ingredientMeasure="",this.imageUrl=null,this.model={titolo:"",descrizione:"",tempocottura:null,porzioni:1,procedimento:"",immagineUrl:"",categoriaid:void 0,alimentazioneid:void 0,ingredientiquantita:[]}}ngOnInit(){this.loadAvailableIngredients(),this.loadAvailableCategories(),this.loadAvailableDiets(),console.log(this.availableCategories)}loadAvailableIngredients(){this.ingredientService.getIngredients().subscribe(e=>{this.availableIngredients=e.sort((s,i)=>s.name.localeCompare(i.name)),console.log(this.availableIngredients)},e=>{console.error("Error fetching ingredients",e)})}loadAvailableCategories(){this.categoryService.getCategories().subscribe(e=>{this.availableCategories=e.sort((s,i)=>s.name.localeCompare(i.name))},e=>{console.error("Error fetching categories",e)})}loadAvailableDiets(){this.dietService.getDiets().subscribe(e=>{this.availableDiets=e.sort((s,i)=>s.name.localeCompare(i.name))},e=>{console.error("Error fetching categories",e)})}addIngredient(){this.selectedIngredient&&(this.model.ingredientiquantita.push({ingredienteId:this.selectedIngredient,ingredienteNome:this.availableIngredients.find(e=>e.id==this.selectedIngredient).name,quantita:this.ingredientQuantity,unitaMisura:this.ingredientMeasure}),this.selectedIngredient=void 0,this.ingredientQuantity=null,this.ingredientMeasure="")}removeIngredient(e){if(e){let s=this.model.ingredientiquantita.findIndex(i=>i.ingredienteNome===e);s!==-1&&this.model.ingredientiquantita.splice(s,1)}}onFileSelected(e){let s=e.target.files[0];if(console.log(s),s){let i=new FileReader;i.onload=d=>{this.imageUrl=d.target?.result,this.model.immagineUrl=d.target.result.split(",")[1]},i.readAsDataURL(s)}else this.imageUrl=null,this.model.immagineUrl=""}onSubmit(e){if(console.log("Form submitted",e.value),e.invalid){console.error("Form is invalid",e.errors);return}console.log("Form is valid",e.value),console.log(this.model),this.addRecipeSubscription=this.recipeService.addRecipe(this.model).subscribe({next:s=>{console.log("Recipe added"),this.router.navigate(["/admin/recipes"])},error:s=>{console.error("Error adding recipe",s)}})}ngOnDestroy(){this.addRecipeSubscription&&this.addRecipeSubscription.unsubscribe()}static{this.\u0275fac=function(s){return new(s||t)}}static{this.\u0275cmp=F({type:t,selectors:[["app-add-recipe"]],decls:79,vars:21,consts:[["form","ngForm"],["titolo","ngModel"],["tempocottura","ngModel"],["porzioni","ngModel"],["categoriaid","ngModel"],["alimentazioneid","ngModel"],["steps","ngModel"],[1,"container"],[1,"mt-3","text-center","text-orange"],[1,"mt-3"],[3,"ngSubmit"],[1,"mb-3"],["for","title",1,"form-label","text-orange","text-bold"],["type","text","id","recipeTitle","name","recipeTitle","placeholder","Inserisci il titolo","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","description",1,"form-label","text-orange","text-bold"],["type","text","id","description","name","description","placeholder","Inserisci la descrizione",1,"form-control",3,"ngModelChange","ngModel"],["for","cookTime",1,"form-label","text-orange","text-bold"],["type","number","id","cookTime","name","cookTime","placeholder","Inserisci il tempo di cottura","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","servings",1,"form-label","text-orange","text-bold"],["type","number","id","servings","name","servings","placeholder","Inserisci il numero di porzioni","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","ingredients",1,"form-label","text-orange","text-bold"],["name","categoriaid","required","",1,"form-select",3,"ngModelChange","ngModel"],["disabled","","selected","",3,"ngValue"],[3,"ngValue"],[1,"text-red"],["name","alimentazioneid","required","",1,"form-select",3,"ngModelChange","ngModel"],[3,"value"],[1,"input-group","mb-3","col-12"],["name","selectedIngredient",1,"form-select",3,"ngModelChange","ngModel"],["disabled","",3,"ngValue"],["type","text","placeholder","Quantit\xE0","name","ingredientQuantity",1,"form-control",3,"ngModelChange","ngModel"],["type","text","placeholder","Unit\xE0 di misura","name","ingredientMeasure",1,"form-control",3,"ngModelChange","ngModel"],["type","button",1,"btn","btn-outline-secondary",3,"click"],[1,"list-group"],[1,"list-group-item","d-flex","justify-content-between","align-items-center"],["for","steps",1,"form-label","text-orange","text-bold"],["id","steps","name","steps","placeholder","Descrivi gli step separandoli da un punto e virgola","required","",1,"form-control",3,"ngModelChange","ngModel"],[1,"text-orange","text-bold"],["type","file","accept","image/*",1,"form-control",3,"change"],["type","submit",1,"btn","btn-light","border-orange","mb-3"],[1,"fa-solid","fa-plus","me-2"],["type","button",1,"btn","btn-light","btn-sm",3,"click"],[1,"bi","bi-trash"],["alt","Immagine caricata",1,"img-thumbnail",2,"max-width","200px",3,"src"]],template:function(s,i){if(s&1){let d=T();r(0,"div",7)(1,"h1",8),l(2,"Crea nuova ricetta"),n(),r(3,"div",9)(4,"form",10,0),E("ngSubmit",function(){p(d);let o=f(5);return g(i.onSubmit(o))}),r(6,"div",11)(7,"label",12),l(8,"Titolo"),n(),r(9,"input",13,1),h("ngModelChange",function(o){return p(d),b(i.model.titolo,o)||(i.model.titolo=o),g(o)}),n(),_(11,ne,1,1),n(),r(12,"div",11)(13,"label",14),l(14,"Descrizione"),n(),r(15,"input",15),h("ngModelChange",function(o){return p(d),b(i.model.descrizione,o)||(i.model.descrizione=o),g(o)}),n()(),r(16,"div",11)(17,"label",16),l(18,"Tempo di cottura"),n(),r(19,"input",17,2),h("ngModelChange",function(o){return p(d),b(i.model.tempocottura,o)||(i.model.tempocottura=o),g(o)}),n(),_(21,re,1,1),n(),r(22,"div",11)(23,"label",18),l(24,"Porzioni"),n(),r(25,"input",19,3),h("ngModelChange",function(o){return p(d),b(i.model.porzioni,o)||(i.model.porzioni=o),g(o)}),n(),_(27,le,1,1),n(),r(28,"div",11)(29,"label",20),l(30,"Categoria"),n(),r(31,"select",21,4),h("ngModelChange",function(o){return p(d),b(i.model.categoriaid,o)||(i.model.categoriaid=o),g(o)}),r(33,"option",22),l(34,"Seleziona una categoria"),n(),w(35,de,2,2,"option",23,M),n(),_(37,me,2,0,"small",24),n(),r(38,"div",11)(39,"label",20),l(40,"Tipo di alimentazione"),n(),r(41,"select",25,5),h("ngModelChange",function(o){return p(d),b(i.model.alimentazioneid,o)||(i.model.alimentazioneid=o),g(o)}),r(43,"option",22),l(44,"Seleziona una alimentazione"),n(),w(45,se,2,2,"option",26,M),n(),_(47,ce,2,0,"small",24),n(),r(48,"div",11)(49,"label",20),l(50,"Ingredienti"),n(),r(51,"div",27)(52,"select",28),h("ngModelChange",function(o){return p(d),b(i.selectedIngredient,o)||(i.selectedIngredient=o),g(o)}),r(53,"option",29),l(54,"Seleziona un ingrediente"),n(),w(55,pe,2,2,"option",26,M),n(),r(57,"input",30),h("ngModelChange",function(o){return p(d),b(i.ingredientQuantity,o)||(i.ingredientQuantity=o),g(o)}),n(),r(58,"input",31),h("ngModelChange",function(o){return p(d),b(i.ingredientMeasure,o)||(i.ingredientMeasure=o),g(o)}),n(),r(59,"button",32),E("click",function(){return p(d),g(i.addIngredient())}),l(60,"+"),n()(),_(61,ge,2,0,"small",24),r(62,"ul",33),w(63,Ce,6,3,"li",34,M),n()(),r(65,"div",11)(66,"label",35),l(67,"Procedimento"),n(),r(68,"textarea",36,6),h("ngModelChange",function(o){return p(d),b(i.model.procedimento,o)||(i.model.procedimento=o),g(o)}),n(),_(70,be,2,0,"small",24),n(),r(71,"div",11)(72,"label",37),l(73,"Carica un'immagine:"),n(),r(74,"input",38),E("change",function(o){return p(d),g(i.onFileSelected(o))}),n(),_(75,he,2,1,"div",9),n(),r(76,"button",39),A(77,"i",40),l(78,"Crea"),n()()()()}if(s&2){let d=f(5),c=f(10),o=f(20),R=f(26),V=f(32),z=f(42),W=f(69);a(9),C("ngModel",i.model.titolo),a(2),u(c.invalid&&(c.touched||d.submitted)?11:-1),a(4),C("ngModel",i.model.descrizione),a(4),C("ngModel",i.model.tempocottura),a(2),u(o.invalid&&(o.touched||d.submitted)?21:-1),a(4),C("ngModel",i.model.porzioni),a(2),u(R.invalid&&(R.touched||d.submitted)?27:-1),a(4),C("ngModel",i.model.categoriaid),a(2),S("ngValue",void 0),a(2),x(i.availableCategories),a(2),u(V.invalid&&(V.touched||d.submitted)?37:-1),a(4),C("ngModel",i.model.alimentazioneid),a(2),S("ngValue",void 0),a(2),x(i.availableDiets),a(2),u(z.invalid&&(z.touched||d.submitted)?47:-1),a(5),C("ngModel",i.selectedIngredient),a(),S("ngValue",void 0),a(2),x(i.availableIngredients),a(2),C("ngModel",i.ingredientQuantity),a(),C("ngModel",i.ingredientMeasure),a(3),u(i.model.ingredientiquantita.length==0&&d.submitted?61:-1),a(2),x(i.model.ingredientiquantita),a(5),C("ngModel",i.model.procedimento),a(2),u(W.invalid&&(W.touched||d.submitted)?70:-1),a(5),u(i.imageUrl?75:-1)}},dependencies:[Z,G,K,X,L,H,J,U,Q,Y,j,O],styles:[".form-control[_ngcontent-%COMP%]:focus{border-color:#f8f9fa;box-shadow:0 0 0 .2rem #474a51}.form-select[_ngcontent-%COMP%]:focus{border-color:#f8f9fa;box-shadow:0 0 0 .2rem #474a51}"]})}}return t})();export{Re as AddRecipeComponent};
