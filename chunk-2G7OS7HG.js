import{a as Q}from"./chunk-B4VVGDZ3.js";import{a as V}from"./chunk-JC5442BX.js";import{e as F,h as A}from"./chunk-YNLNNLDO.js";import{b as z,c as P,f as B,m as j}from"./chunk-HZ2NMNNL.js";import"./chunk-N7HB2IBM.js";import{$ as f,Ba as r,Fa as S,Gb as a,Hb as x,Ib as g,Lb as k,Mb as T,Nb as I,Oa as E,Pb as D,Qb as C,Ta as p,U as b,aa as v,db as u,ib as h,kb as M,lb as w,mb as L,nb as n,ob as o,pb as l,tb as y,ub as _,vb as d,za as R}from"./chunk-L66XQOBG.js";var O=()=>["/admin/recipes/add"],N=t=>["/admin/recipes",t],U=t=>["/admin/recipes/update",t];function W(t,s){t&1&&(n(0,"div",19)(1,"a",22),l(2,"i",23),a(3,"Nuova Ricetta "),o()()),t&2&&(r(),u("routerLink",D(1,O)))}function q(t,s){t&1&&l(0,"i",38)}function G(t,s){t&1&&l(0,"i",38)}function H(t,s){t&1&&l(0,"i",39)}function J(t,s){if(t&1){let e=y();n(0,"button",45),_("click",function(){f(e);let c=d().$implicit,m=d(2);return v(m.openDeleteModal(c.id))}),l(1,"i",46),o()}}function K(t,s){if(t&1&&(n(0,"div",21)(1,"div",24)(2,"a",25),l(3,"img",26),o()(),n(4,"div",27)(5,"div",28)(6,"div")(7,"p",29)(8,"span"),l(9,"i",30),n(10,"strong",31),a(11),o()(),n(12,"span",32),l(13,"i",33),a(14),l(15,"i",34),a(16,"5 "),o()(),n(17,"p")(18,"strong",31),a(19),o()(),n(20,"p"),a(21),o()(),n(22,"div",35)(23,"p",29)(24,"span"),l(25,"i",36)(26,"strong",31),a(27),l(28,"i",37)(29,"strong",31),a(30),p(31,q,1,0,"i",38)(32,G,1,0,"i",38)(33,H,1,0,"i",39),o(),n(34,"span"),p(35,J,2,0,"button",40),n(36,"button",41),l(37,"i",42),o(),n(38,"button",43),l(39,"i",44),o()()()()()()()),t&2){let e=s.$implicit,i=d(2);r(2),u("routerLink",C(12,N,e.id)),r(),u("src","data:image/jpeg;base64,"+e.immagineurl,R),r(8),x(e.categorianome),r(3),g("",e.recipeUser.length," "),r(5),x(e.titolo),r(2),x(e.descrizione),r(6),g("",e.tempocottura," "),r(3),g("",e.porzioni," "),r(),h(e.alimentazionenome=="Vegetariana"?31:e.alimentazionenome=="Vegana"?32:e.alimentazionenome=="Celiaca"?33:-1),r(4),h(i.user!==void 0&&i.user.roles.includes("Admin")?35:-1),r(),u("routerLink",C(14,U,e.id)),r(2),u("routerLink",C(16,N,e.id))}}function X(t,s){if(t&1){let e=y();n(0,"div")(1,"div",11)(2,"h1",12),a(3,"Tutte le ricette di Ale in borghese"),o(),n(4,"div",13)(5,"div",14)(6,"div",15)(7,"input",16),I("ngModelChange",function(c){f(e);let m=d();return T(m.searchQuery,c)||(m.searchQuery=c),v(c)}),_("input",function(){f(e);let c=d();return v(c.filterRecipes())}),o(),n(8,"button",17),l(9,"i",18),o()()(),p(10,W,4,2,"div",19),o(),n(11,"ul",20),w(12,K,40,18,"div",21,M),o()()()}if(t&2){let e=d();r(7),k("ngModel",e.searchQuery),r(3),h(e.user!==void 0?10:-1),r(2),L(e.filteredRecipes)}}function Y(t,s){if(t&1&&(n(0,"div",10),a(1),o()),t&2){let e=d();r(),g(" \u26A0\uFE0F ",e.errorMessage,`
`)}}var le=(()=>{class t{constructor(){this.authService=b(Q),this.recipeService=b(V),this.route=b(F),this.renderer=b(S),this.availableRecipes=[],this.errorMessage=null,this.filteredRecipes=[],this.searchQuery="",this.categoryQuery="",this.recipeIdToDelete=null}detailsRecipe(e){this.detailsRecipeSubscription=this.recipeService.getRecipeDetails(e).subscribe({next:i=>{console.log("Recipe details",i)},error:i=>{console.error("Error fetching recipe details",i),this.errorMessage=i.message},complete:()=>console.log("Chiamata API completata")})}deleteRecipe(e){this.deleteRecipeSubscription=this.recipeService.deleteRecipe(e).subscribe({next:i=>{console.log("Recipe deleted",i),this.loadRecipes()},error:i=>{console.error("Error deleting recipe",i),this.errorMessage=i.message},complete:()=>console.log("Chiamata API completata")})}editRecipe(e){throw new Error("Method not implemented.")}openDeleteModal(e){this.recipeIdToDelete=e;let i=document.getElementById("deleteModal");i&&(this.renderer.addClass(i,"show"),this.renderer.setStyle(i,"display","block"),this.renderer.setAttribute(i,"aria-modal","true"),this.renderer.setAttribute(i,"role","dialog"))}closeDeleteModal(){let e=document.getElementById("deleteModal");e&&(this.renderer.removeClass(e,"show"),this.renderer.setStyle(e,"display","none"),this.renderer.removeAttribute(e,"aria-modal"),this.renderer.removeAttribute(e,"role"))}confirmDelete(){this.recipeIdToDelete!==null&&this.recipeService.deleteRecipe(this.recipeIdToDelete).subscribe(()=>{this.loadRecipes(),this.recipeIdToDelete=null,this.closeDeleteModal()},e=>{this.errorMessage="Errore nell'eliminazione della ricetta"})}ngOnInit(){this.authService.user().subscribe({next:e=>this.user=e}),this.user=this.authService.getUser(),this.route.queryParams.subscribe(e=>{this.searchQuery=e.search||"",this.categoryQuery=e.category||"",this.loadRecipes()})}loadRecipes(){this.getRecipeSubscription=this.recipeService.getRecipes().subscribe({next:e=>{this.availableRecipes=e,this.filterRecipes()},error:e=>{console.error("Error fetching recipes",e),this.errorMessage=e.message},complete:()=>console.log("Chiamata API completata")})}filterRecipes(){console.log("Filtering recipes with text:",this.searchQuery),this.searchQuery?this.filteredRecipes=this.availableRecipes.filter(e=>e.titolo.toLowerCase().includes(this.searchQuery.toLowerCase())):this.categoryQuery?(console.log("Filtering recipes with category:",this.categoryQuery),this.filteredRecipes=this.availableRecipes.filter(e=>e.categorianome.includes(this.categoryQuery))):this.filteredRecipes=this.availableRecipes}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=E({type:t,selectors:[["app-recipe-list"]],decls:16,vars:2,consts:[["id","deleteModal","tabindex","-1","aria-labelledby","deleteModalLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],["id","deleteModalLabel",1,"modal-title","text-orange"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-danger",3,"click"],[1,"error"],[1,"container"],[1,"mt-3",2,"color","#e84919"],[1,"row","align-items-center","mb-3","mt-4"],[1,"col-12","col-md-5","mb-2","mb-md-0"],[1,"input-group"],["type","text","placeholder","Filtra ricette...",1,"form-control",3,"ngModelChange","input","ngModel"],["type","button",1,"btn","btn-light","border-orange"],[1,"fa-solid","fa-magnifying-glass",2,"color","#e84919"],[1,"col-12","col-md-3","text-md-end"],[1,"list-group","mb-4"],[1,"row","g-0","mt-4"],[1,"btn","btn-light","w-100","w-md-auto",2,"border-color","#e84919",3,"routerLink"],[1,"fa-solid","fa-plus","me-1"],[1,"col-12","col-md-3"],[1,"text-decoration-none",3,"routerLink"],["alt","...",1,"img-fluid","d-block","w-100",2,"width","485px","height","250px",3,"src"],[1,"col-12","col-md-5","d-flex","flex-column",2,"background-color","rgba(247, 246, 248, 1)"],[1,"p-2","d-flex","flex-column","h-100"],[1,"d-flex","justify-content-between","align-items-center"],[1,"fa-solid","fa-bowl-rice","me-2"],[2,"color","#e84919"],[1,"me-2"],[1,"bi","bi-chat-left-heart-fill","me-1"],[1,"fa-solid","fa-star","ms-2","me-1",2,"color","gold"],[1,"px-2","pt-2","mt-auto"],[1,"bi","bi-clock-fill","me-2"],[1,"fa-solid","fa-people-group","ms-4","me-2"],[1,"fa-solid","fa-leaf","ms-4","me-2"],[1,"fa-solid","fa-bread-slice","ms-4","me-2"],[1,"btn","btn-light","btn-sm","me-2"],[1,"btn","btn-light","btn-sm","me-2",3,"routerLink"],[1,"bi","bi-pencil"],[1,"btn","btn-light","btn-sm",3,"routerLink"],[1,"bi","bi-book"],[1,"btn","btn-light","btn-sm","me-2",3,"click"],[1,"bi","bi-trash"]],template:function(i,c){i&1&&(p(0,X,14,2,"div"),n(1,"div",0)(2,"div",1)(3,"div",2)(4,"div",3)(5,"h5",4),a(6,"Conferma eliminazione"),o(),n(7,"button",5),_("click",function(){return c.closeDeleteModal()}),o()(),n(8,"div",6),a(9," Sei sicuro di voler eliminare questa ricetta? "),o(),n(10,"div",7)(11,"button",8),_("click",function(){return c.closeDeleteModal()}),a(12,"Annulla"),o(),n(13,"button",9),_("click",function(){return c.confirmDelete()}),a(14,"Elimina"),o()()()()(),p(15,Y,2,1,"div",10)),i&2&&(h(c.errorMessage?-1:0),r(15),h(c.errorMessage?15:-1))},dependencies:[j,z,P,B,A],styles:[".btn-transparent.dropdown-toggle[_ngcontent-%COMP%]:after{display:none}.form-control[_ngcontent-%COMP%]:focus{border-color:#e84919;box-shadow:0 0 0 .2rem #e8491940}"]})}}return t})();export{le as RecipeListComponent};
