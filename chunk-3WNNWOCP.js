import{a as N}from"./chunk-AYUVLKKD.js";import"./chunk-UISL6Y2D.js";import{a as z}from"./chunk-EAAMTQQM.js";import{a as V}from"./chunk-735NRJNZ.js";import{f as A,i as Q}from"./chunk-2TPUGOKS.js";import{b as P,c as B,f as j,m as q}from"./chunk-Y4UBL3LJ.js";import{$ as v,$a as h,Ab as C,Cb as b,Db as d,Ga as R,Ia as r,Na as S,Ob as a,Pb as x,Qb as f,T as u,Tb as k,Ub as T,Vb as F,Wa as w,Xb as I,Yb as y,Zb as D,_ as g,kb as _,pb as p,rb as E,sb as L,tb as M,ub as n,vb as o,wb as l}from"./chunk-BF6ZZEZH.js";var U=()=>["/admin/recipes/add"],O=t=>["/admin/recipes",t],W=(t,c)=>["/admin/recipes/update",t,c];function $(t,c){t&1&&(n(0,"div",19)(1,"a",22),l(2,"i",23),a(3,"Nuova Ricetta "),o()()),t&2&&(r(),_("routerLink",I(1,U)))}function G(t,c){t&1&&l(0,"i",38)}function H(t,c){t&1&&l(0,"i",38)}function J(t,c){t&1&&l(0,"i",39)}function K(t,c){if(t&1){let e=C();n(0,"button",44),b("click",function(){g(e);let s=d().$implicit,m=d(2);return v(m.openDeleteModal(s.id))}),l(1,"i",45),o()}}function X(t,c){if(t&1&&(n(0,"button",41),l(1,"i",46),o()),t&2){let e=d().$implicit;_("routerLink",D(1,W,e.author,e.id))}}function Y(t,c){if(t&1&&(n(0,"div",21)(1,"div",24)(2,"a",25),l(3,"img",26),o()(),n(4,"div",27)(5,"div",28)(6,"div")(7,"p",29)(8,"span"),l(9,"i",30),n(10,"strong",31),a(11),o()(),n(12,"span",32),l(13,"i",33),a(14),l(15,"i",34),a(16,"5 "),o()(),n(17,"p")(18,"strong",31),a(19),o()(),n(20,"p"),a(21),o()(),n(22,"div",35)(23,"p",29)(24,"span"),l(25,"i",36)(26,"strong",31),a(27),l(28,"i",37)(29,"strong",31),a(30),h(31,G,1,0,"i",38)(32,H,1,0,"i",38)(33,J,1,0,"i",39),o(),n(34,"span"),h(35,K,2,0,"button",40)(36,X,2,4,"button",41),n(37,"button",42),l(38,"i",43),o()()()()()()()),t&2){let e=c.$implicit,i=d(2);r(2),_("routerLink",y(12,O,e.id)),r(),_("src","data:image/jpeg;base64,"+e.immagineurl,R),r(8),x(e.categorianome),r(3),f("",e.recipeUser.length," "),r(5),x(e.titolo),r(2),x(e.descrizione),r(6),f("",e.tempocottura," "),r(3),f("",e.porzioni," "),r(),p(e.alimentazionenome=="Vegetariana"?31:e.alimentazionenome=="Vegana"?32:e.alimentazionenome=="Celiaca"?33:-1),r(4),p(i.user!==void 0&&i.user.roles.includes("Admin")?35:-1),r(),p(i.user!==void 0&&i.user.roles.includes("writer")&&i.user.username===e.author?36:-1),r(),_("routerLink",y(14,O,e.id))}}function Z(t,c){if(t&1){let e=C();n(0,"div")(1,"div",11)(2,"h1",12),a(3,"Tutte le ricette di Ale in borghese"),o(),n(4,"div",13)(5,"div",14)(6,"div",15)(7,"input",16),F("ngModelChange",function(s){g(e);let m=d();return T(m.searchQuery,s)||(m.searchQuery=s),v(s)}),b("input",function(){g(e);let s=d();return v(s.filterRecipes())}),o(),n(8,"button",17),l(9,"i",18),o()()(),h(10,$,4,2,"div",19),o(),n(11,"ul",20),L(12,Y,39,16,"div",21,E),o()()()}if(t&2){let e=d();r(7),k("ngModel",e.searchQuery),r(3),p(e.user!==void 0?10:-1),r(2),M(e.filteredRecipes)}}function ee(t,c){if(t&1&&(n(0,"div",10),a(1),o()),t&2){let e=d();r(),f(" \u26A0\uFE0F ",e.errorMessage,`
`)}}var de=(()=>{class t{constructor(){this.authService=u(V),this.recipeService=u(z),this.route=u(A),this.renderer=u(S),this.toastr=u(N),this.availableRecipes=[],this.errorMessage=null,this.filteredRecipes=[],this.searchQuery="",this.categoryQuery="",this.recipeIdToDelete=null}deleteRecipe(e){this.deleteRecipeSubscription=this.recipeService.deleteRecipe(e).subscribe({next:i=>{console.log("Recipe deleted",i),this.loadRecipes()},error:i=>{console.error("Error deleting recipe",i),this.errorMessage=i.message},complete:()=>console.log("Chiamata API completata")})}editRecipe(e){throw new Error("Method not implemented.")}openDeleteModal(e){this.recipeIdToDelete=e;let i=document.getElementById("deleteModal");i&&(this.renderer.addClass(i,"show"),this.renderer.setStyle(i,"display","block"),this.renderer.setAttribute(i,"aria-modal","true"),this.renderer.setAttribute(i,"role","dialog"))}closeDeleteModal(){let e=document.getElementById("deleteModal");e&&(this.renderer.removeClass(e,"show"),this.renderer.setStyle(e,"display","none"),this.renderer.removeAttribute(e,"aria-modal"),this.renderer.removeAttribute(e,"role"))}confirmDelete(){this.recipeIdToDelete!==null&&this.recipeService.deleteRecipe(this.recipeIdToDelete).subscribe(()=>{this.loadRecipes(),this.recipeIdToDelete=null,this.closeDeleteModal()},e=>{this.errorMessage="Errore nell'eliminazione della ricetta"})}showToast(){console.log("Click sul bottone, mostro toast"),this.toastr.success("Test toast visibile!","Successo")}ngOnInit(){this.authService.user().subscribe({next:e=>this.user=e}),this.user=this.authService.getUser(),console.log(this.user?.username),this.route.queryParams.subscribe(e=>{this.searchQuery=e.query||"",this.categoryQuery=e.category||"",this.loadRecipes()})}loadRecipes(){this.getRecipeSubscription=this.recipeService.getRecipes().subscribe({next:e=>{this.availableRecipes=e,console.log(this.availableRecipes),this.filterRecipes()},error:e=>{console.error("Error fetching recipes",e),this.errorMessage=e.message},complete:()=>console.log("Chiamata API completata")})}filterRecipes(){console.log("Filtering recipes with text:",this.searchQuery),this.searchQuery?this.filteredRecipes=this.availableRecipes.filter(e=>e.titolo.toLowerCase().includes(this.searchQuery.toLowerCase())):this.categoryQuery?(console.log("Filtering recipes with category:",this.categoryQuery),this.filteredRecipes=this.availableRecipes.filter(e=>e.categorianome.includes(this.categoryQuery))):this.filteredRecipes=this.availableRecipes}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=w({type:t,selectors:[["app-recipe-list"]],decls:16,vars:2,consts:[["id","deleteModal","tabindex","-1","aria-labelledby","deleteModalLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],["id","deleteModalLabel",1,"modal-title","text-orange"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-danger",3,"click"],[1,"error"],[1,"container"],[1,"mt-3",2,"color","#e84919"],[1,"row","align-items-center","mb-3","mt-4"],[1,"col-12","col-md-5","mb-2","mb-md-0"],[1,"input-group"],["type","text","placeholder","Filtra ricette...",1,"form-control",3,"ngModelChange","input","ngModel"],["type","button",1,"btn","btn-light","border-orange"],[1,"fa-solid","fa-magnifying-glass",2,"color","#e84919"],[1,"col-12","col-md-3","text-md-end"],[1,"list-group","mb-4"],[1,"row","g-0","mt-4"],[1,"btn","btn-light","w-100","w-md-auto",2,"border-color","#e84919",3,"routerLink"],[1,"fa-solid","fa-plus","me-1"],[1,"col-12","col-md-3"],[1,"text-decoration-none",3,"routerLink"],["alt","...",1,"img-fluid","d-block","w-100",2,"width","485px","height","250px",3,"src"],[1,"col-12","col-md-5","d-flex","flex-column",2,"background-color","rgba(247, 246, 248, 1)"],[1,"p-2","d-flex","flex-column","h-100"],[1,"d-flex","justify-content-between","align-items-center"],[1,"fa-solid","fa-bowl-rice","me-2"],[2,"color","#e84919"],[1,"me-2"],[1,"bi","bi-chat-left-heart-fill","me-1"],[1,"fa-solid","fa-star","ms-2","me-1",2,"color","gold"],[1,"px-2","pt-2","mt-auto"],[1,"bi","bi-clock-fill","me-2"],[1,"fa-solid","fa-people-group","ms-4","me-2"],[1,"fa-solid","fa-leaf","ms-4","me-2"],[1,"fa-solid","fa-bread-slice","ms-4","me-2"],[1,"btn","btn-light","btn-sm","me-2"],[1,"btn","btn-light","btn-sm","me-2",3,"routerLink"],[1,"btn","btn-light","btn-sm",3,"routerLink"],[1,"bi","bi-book"],[1,"btn","btn-light","btn-sm","me-2",3,"click"],[1,"bi","bi-trash"],[1,"bi","bi-pencil"]],template:function(i,s){i&1&&(h(0,Z,14,2,"div"),n(1,"div",0)(2,"div",1)(3,"div",2)(4,"div",3)(5,"h5",4),a(6,"Conferma eliminazione"),o(),n(7,"button",5),b("click",function(){return s.closeDeleteModal()}),o()(),n(8,"div",6),a(9," Sei sicuro di voler eliminare questa ricetta? "),o(),n(10,"div",7)(11,"button",8),b("click",function(){return s.closeDeleteModal()}),a(12,"Annulla"),o(),n(13,"button",9),b("click",function(){return s.confirmDelete()}),a(14,"Elimina"),o()()()()(),h(15,ee,2,1,"div",10)),i&2&&(p(s.errorMessage?-1:0),r(15),p(s.errorMessage?15:-1))},dependencies:[q,P,B,j,Q],styles:[".btn-transparent.dropdown-toggle[_ngcontent-%COMP%]:after{display:none}.form-control[_ngcontent-%COMP%]:focus{border-color:#e84919;box-shadow:0 0 0 .2rem #e8491940}"]})}}return t})();export{de as RecipeListComponent};
