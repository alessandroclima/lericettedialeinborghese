import{k as u}from"./chunk-2TPUGOKS.js";import{Lc as l,N as n,Oc as r,T as o,i as a}from"./chunk-BF6ZZEZH.js";var S=(()=>{class t{constructor(){this.http=o(l),this.cookieService=o(u),this.$user=new a(void 0),this.loginUserUrl=`${r.apiBaseUrl}/api/Auth/Login`,this.registerUserUrl=`${r.apiBaseUrl}/api/Auth/Register`}resetPassword(e){return this.http.post(`${r.apiBaseUrl}/api/Auth/reset-password`,e)}forgotPassword(e){return this.http.post(`${r.apiBaseUrl}/api/Auth/forgot-password`,e)}loginUser(e){return this.http.post(this.loginUserUrl,e)}registerUser(e){return this.http.post(this.registerUserUrl,e)}setUser(e){this.$user.next(e),localStorage.setItem("user-username",e.username),localStorage.setItem("user-email",e.email),localStorage.setItem("user-roles",e.roles.join(","))}user(){return this.$user.asObservable()}logout(){localStorage.clear(),this.cookieService.delete("Authorization","/"),this.$user.next(void 0)}getUser(){let e=localStorage.getItem("user-username"),s=localStorage.getItem("user-email"),i=localStorage.getItem("user-roles");if(e&&s&&i)return{username:e,email:s,roles:i.split(",")}}static{this.\u0275fac=function(s){return new(s||t)}}static{this.\u0275prov=n({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();export{S as a};
